{"ast":null,"code":"var _jsxFileName = \"/Users/leoniangela/Downloads/Uni Year 3/Year 3 Sem 2/IT Project/ITProject/client/src/pages/Login/LoginForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport './login.css';\nimport axios from 'axios';\nimport Cookies from \"universal-cookie\"; // Cookies for checking if the user is currently logged in\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst cookies = new Cookies(); // login states for coloring with \"inputClass\"\n\nconst states = {\n  initial: 'login-initial',\n  invalid: 'login-invalid',\n  valid: 'login-valid'\n};\nconst feedbackMapper = {\n  'login-initial': '',\n  'login-invalid': 'Invalid username or password. Please try again',\n  'login-valid': 'Successfully logged in!'\n};\nexport default function LoginForm() {\n  _s();\n\n  // const navigate = useNavigate();\n  let [loginState, setLoginState] = useState({\n    isValid: false,\n    currState: states.initial\n  });\n  const [username, setUserName] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n\n  async function handleLogin(e) {\n    // set configurations\n    setLoginState({\n      validLogin: false\n    });\n    const configuration = {\n      method: \"post\",\n      url: \"http://localhost:5100/login\",\n      data: {\n        username,\n        password\n      }\n    }; // prevent the form from refreshing the whole page\n\n    e.preventDefault(); // make the API call\n\n    await axios(configuration).then(res => {\n      // set the cookie upon successful login\n      cookies.set(\"TOKEN\", res.data.token, {\n        path: \"/\"\n      });\n      inputClass = res.data.isValid ? states.valid : states.invalid;\n      setLoginState({\n        currState: inputClass,\n        isValid: res.data.isValid\n      });\n    }).catch(err => {\n      console.log(\"fail login\");\n      inputClass = states.invalid;\n      setLoginState({\n        currState: inputClass,\n        isValid: false\n      });\n      console.log(err);\n    });\n  }\n\n  if (loginState.isValid) {\n    window.location.href = '/dashboard';\n  }\n\n  let inputClass;\n  inputClass = 'input-field ' + loginState.currState;\n  let feedbackMessage = feedbackMapper[loginState.currState];\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    action: \"/login\",\n    method: \"post\",\n    onSubmit: e => handleLogin(e),\n    children: /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: [/*#__PURE__*/_jsxDEV(\"li\", {\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \" Username \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        className: inputClass,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"material-icons\",\n          children: \"mail\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"userName\",\n          onChange: e => setUserName(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \" Password \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        className: inputClass,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"material-icons\",\n          children: \"lock\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          id: \"password\",\n          onChange: e => setPassword(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"feedback\",\n          children: feedbackMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"Sign In\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 11\n  }, this);\n}\n\n_s(LoginForm, \"1cXBY9A+HwIG3KhOphyYRrQcgTc=\");\n\n_c = LoginForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginForm\");","map":{"version":3,"names":["React","useState","axios","Cookies","cookies","states","initial","invalid","valid","feedbackMapper","LoginForm","loginState","setLoginState","isValid","currState","username","setUserName","password","setPassword","handleLogin","e","validLogin","configuration","method","url","data","preventDefault","then","res","set","token","path","inputClass","catch","err","console","log","window","location","href","feedbackMessage","target","value"],"sources":["/Users/leoniangela/Downloads/Uni Year 3/Year 3 Sem 2/IT Project/ITProject/client/src/pages/Login/LoginForm.js"],"sourcesContent":["import React, { useState } from 'react';\nimport './login.css';\nimport axios from 'axios';\nimport Cookies from \"universal-cookie\";\n\n// Cookies for checking if the user is currently logged in\nconst cookies = new Cookies();\n\n// login states for coloring with \"inputClass\"\nconst states = {\n    initial: 'login-initial',\n    invalid: 'login-invalid',\n    valid: 'login-valid',\n};\n\nconst feedbackMapper = {\n    'login-initial' : '',\n    'login-invalid' : 'Invalid username or password. Please try again',\n    'login-valid' : 'Successfully logged in!',\n}\n\nexport default function LoginForm () {\n    // const navigate = useNavigate();\n    let [loginState, setLoginState] = useState({\n        isValid: false,\n        currState: states.initial,\n    });\n    const [username, setUserName] = useState(\"\");\n    const [password ,setPassword] = useState(\"\");\n    \n    async function handleLogin (e) {\n      // set configurations\n      setLoginState({validLogin: false});\n      const configuration = {\n        method: \"post\",\n        url: \"http://localhost:5100/login\",\n        data: {\n          username,\n          password,\n        },\n      };\n\n      // prevent the form from refreshing the whole page\n      e.preventDefault();\n\n      // make the API call\n      await axios(configuration).then((res) => {\n        // set the cookie upon successful login\n        cookies.set(\"TOKEN\", res.data.token, {\n            path: \"/\",\n          }) \n          inputClass = (res.data.isValid) ? states.valid : states.invalid;\n          setLoginState({\n              currState: inputClass,\n              isValid: res.data.isValid,\n          });\n          \n      }).catch((err) => {\n        console.log(\"fail login\")\n        inputClass = states.invalid;\n        setLoginState({\n            currState: inputClass,\n            isValid: false\n        });\n          console.log(err);\n      });\n    }\n\n    if (loginState.isValid) {\n        window.location.href = '/dashboard';\n    }\n\n    let inputClass;\n    inputClass = 'input-field ' + loginState.currState\n    let feedbackMessage = feedbackMapper[loginState.currState];\n         \n    return (\n          <form action='/login' method='post' onSubmit={(e) => handleLogin(e)}>\n            <ul>\n                <li>\n                    <label> Username </label>\n                </li>\n                <li className={inputClass}>\n                    <span className=\"material-icons\">mail</span>\n                    <input\n                        type='text'\n                        id='userName'\n                        onChange={(e) => setUserName(e.target.value)}\n                    />\n                </li>\n                <li>\n                    <label> Password </label>\n                </li>\n                <li className={inputClass}>\n                    <span className=\"material-icons\">lock</span>\n                    <input\n                        type='password'\n                        id='password'\n                        onChange={(e) => setPassword(e.target.value)}\n                    />\n                </li>\n                <li>\n                    <p className='feedback'>{feedbackMessage}</p>\n                </li>\n                <li>\n                    <button type='submit' >Sign In</button>\n                </li>\n            </ul>\n          </form>\n    )\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}