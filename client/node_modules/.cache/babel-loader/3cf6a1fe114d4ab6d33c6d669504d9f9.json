{"ast":null,"code":"import _regeneratorRuntime from\"/Users/leoniangela/Downloads/Uni Year 3/Year 3 Sem 2/IT Project/ITProject/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/leoniangela/Downloads/Uni Year 3/Year 3 Sem 2/IT Project/ITProject/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/leoniangela/Downloads/Uni Year 3/Year 3 Sem 2/IT Project/ITProject/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import'./login.css';import axios from'axios';import Cookies from\"universal-cookie\";// Cookies for checking if the user is currently logged in\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var cookies=new Cookies();// login states for coloring with \"inputClass\"\nvar states={initial:'login-initial',invalid:'login-invalid',valid:'login-valid'};var feedbackMapper={'login-initial':'','login-invalid':'Invalid username or password. Please try again','login-valid':'Successfully logged in!'};export default function LoginForm(){// const navigate = useNavigate();\nvar _useState=useState({isValid:false,currState:states.initial}),_useState2=_slicedToArray(_useState,2),loginState=_useState2[0],setLoginState=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUserName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];function handleLogin(_x){return _handleLogin.apply(this,arguments);}function _handleLogin(){_handleLogin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var configuration;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// set configurations\nsetLoginState({validLogin:false});configuration={method:\"post\",url:\"http://localhost:5100/login\",data:{username:username,password:password}};// prevent the form from refreshing the whole page\ne.preventDefault();// make the API call\n_context.next=5;return axios(configuration).then(function(res){// set the cookie upon successful login\ncookies.set(\"TOKEN\",res.data.token,{path:\"/\"});inputClass=res.data.isValid?states.valid:states.invalid;setLoginState({currState:inputClass,isValid:res.data.isValid});}).catch(function(err){console.log(\"fail login\");inputClass=states.invalid;setLoginState({currState:inputClass,isValid:false});console.log(err);});case 5:case\"end\":return _context.stop();}}},_callee);}));return _handleLogin.apply(this,arguments);}if(loginState.isValid){window.location.href='/dashboard';}var inputClass;inputClass='input-field '+loginState.currState;var feedbackMessage=feedbackMapper[loginState.currState];return/*#__PURE__*/_jsx(\"form\",{action:\"/login\",method:\"post\",onSubmit:function onSubmit(e){return handleLogin(e);},children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"label\",{children:\" Username \"})}),/*#__PURE__*/_jsxs(\"li\",{className:inputClass,children:[/*#__PURE__*/_jsx(\"span\",{className:\"material-icons\",children:\"mail\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"userName\",onChange:function onChange(e){return setUserName(e.target.value);}})]}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"label\",{children:\" Password \"})}),/*#__PURE__*/_jsxs(\"li\",{className:inputClass,children:[/*#__PURE__*/_jsx(\"span\",{className:\"material-icons\",children:\"lock\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"p\",{className:\"feedback\",children:feedbackMessage})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Sign In\"})})]})});}","map":{"version":3,"names":["React","useState","axios","Cookies","cookies","states","initial","invalid","valid","feedbackMapper","LoginForm","isValid","currState","loginState","setLoginState","username","setUserName","password","setPassword","handleLogin","e","validLogin","configuration","method","url","data","preventDefault","then","res","set","token","path","inputClass","catch","err","console","log","window","location","href","feedbackMessage","target","value"],"sources":["/Users/leoniangela/Downloads/Uni Year 3/Year 3 Sem 2/IT Project/ITProject/client/src/pages/Login/LoginForm.js"],"sourcesContent":["import React, { useState } from 'react';\nimport './login.css';\nimport axios from 'axios';\nimport Cookies from \"universal-cookie\";\n\n// Cookies for checking if the user is currently logged in\nconst cookies = new Cookies();\n\n// login states for coloring with \"inputClass\"\nconst states = {\n    initial: 'login-initial',\n    invalid: 'login-invalid',\n    valid: 'login-valid',\n};\n\nconst feedbackMapper = {\n    'login-initial' : '',\n    'login-invalid' : 'Invalid username or password. Please try again',\n    'login-valid' : 'Successfully logged in!',\n}\n\nexport default function LoginForm () {\n    // const navigate = useNavigate();\n    let [loginState, setLoginState] = useState({\n        isValid: false,\n        currState: states.initial,\n    });\n    const [username, setUserName] = useState(\"\");\n    const [password ,setPassword] = useState(\"\");\n    \n    async function handleLogin (e) {\n      // set configurations\n      setLoginState({validLogin: false});\n      const configuration = {\n        method: \"post\",\n        url: \"http://localhost:5100/login\",\n        data: {\n          username,\n          password,\n        },\n      };\n\n      // prevent the form from refreshing the whole page\n      e.preventDefault();\n\n      // make the API call\n      await axios(configuration).then((res) => {\n        // set the cookie upon successful login\n        cookies.set(\"TOKEN\", res.data.token, {\n            path: \"/\",\n          }) \n          inputClass = (res.data.isValid) ? states.valid : states.invalid;\n          setLoginState({\n              currState: inputClass,\n              isValid: res.data.isValid,\n          });\n          \n      }).catch((err) => {\n        console.log(\"fail login\")\n        inputClass = states.invalid;\n        setLoginState({\n            currState: inputClass,\n            isValid: false\n        });\n          console.log(err);\n      });\n    }\n\n    if (loginState.isValid) {\n        window.location.href = '/dashboard';\n    }\n\n    let inputClass;\n    inputClass = 'input-field ' + loginState.currState\n    let feedbackMessage = feedbackMapper[loginState.currState];\n         \n    return (\n          <form action='/login' method='post' onSubmit={(e) => handleLogin(e)}>\n            <ul>\n                <li>\n                    <label> Username </label>\n                </li>\n                <li className={inputClass}>\n                    <span className=\"material-icons\">mail</span>\n                    <input\n                        type='text'\n                        id='userName'\n                        onChange={(e) => setUserName(e.target.value)}\n                    />\n                </li>\n                <li>\n                    <label> Password </label>\n                </li>\n                <li className={inputClass}>\n                    <span className=\"material-icons\">lock</span>\n                    <input\n                        type='password'\n                        id='password'\n                        onChange={(e) => setPassword(e.target.value)}\n                    />\n                </li>\n                <li>\n                    <p className='feedback'>{feedbackMessage}</p>\n                </li>\n                <li>\n                    <button type='submit' >Sign In</button>\n                </li>\n            </ul>\n          </form>\n    )\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}